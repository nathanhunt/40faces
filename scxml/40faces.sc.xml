<scxml
        xmlns="http://www.w3.org/2005/07/scxml"
        version="1.0"
        profile="ecmascript">

    <datamodel>
        <data id="bubbles"/>
        <data id="video"/>
        <data id="audio" />
        <data id="duration"/>
    </datamodel>

    <state id="initial-default">
        <transition event="init" target="loading">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <script>
                bubbles.deploy();
            </script>
        </transition>
    </state>

    <state id="loading">
        <transition event="readyForMain" target="mainView">
            <assign location="video" expr="_event.data.video"/>
            <assign location="audio" expr="_event.data.audio"/>
            <script>
                video.play();
                audio.play();
            </script>
        </transition>
    </state>

    <state id="mainView">
        <transition event="toAbout" target="aboutView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('about', 'main', duration, 'easeInOut');
            </script>
        </transition>
        <transition event="toContact" target="contactView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('contact', 'main', duration, 'easeInOut');
            </script>
        </transition>
    </state>

    <state id="aboutView">
        <transition event="toMain" target="mainView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('main', 'about', duration, 'easeInOut');
            </script>
        </transition>
        <transition event="toContact" target="contactView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('contact', 'about', duration, 'easeInOut');
            </script>
        </transition>
    </state>

    <state id="contactView">
        <transition event="toMain" target="mainView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('main', 'contact', duration, 'easeInOut');
            </script>
        </transition>
        <transition event="toAbout" target="aboutView">
            <assign location="bubbles" expr="_event.data.bubbles"/>
            <assign location="duration" expr="_event.data.duration"/>
            <script>
                bubbles.transition('about', 'contact', duration, 'easeInOut');
            </script>
        </transition>
    </state>

</scxml>